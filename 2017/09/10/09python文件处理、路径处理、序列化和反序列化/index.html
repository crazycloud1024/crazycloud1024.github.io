<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"vampireqian.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.8.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"بحث...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta name="description" content="文件IO常用操作一般说IO操作，指的是文件IO。 把文件存储到磁盘上的这个过程，叫做落地。    column column    open 打开   read 读取   write 写入   close 关闭   readline 行读取   readlines 多行读取   seek 文件指针操作   tell 指针位置   open打开操作12345open(file, mode&#x3D;&amp;#x27">
<meta property="og:type" content="article">
<meta property="og:title" content="python-文件处理、路径处理、序列化和反序列化">
<meta property="og:url" content="https://vampireqian.github.io/2017/09/10/09python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%E3%80%81%E8%B7%AF%E5%BE%84%E5%A4%84%E7%90%86%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/index.html">
<meta property="og:site_name" content="luoqian">
<meta property="og:description" content="文件IO常用操作一般说IO操作，指的是文件IO。 把文件存储到磁盘上的这个过程，叫做落地。    column column    open 打开   read 读取   write 写入   close 关闭   readline 行读取   readlines 多行读取   seek 文件指针操作   tell 指针位置   open打开操作12345open(file, mode&#x3D;&amp;#x27">
<meta property="og:locale">
<meta property="article:published_time" content="2017-09-09T16:00:00.000Z">
<meta property="article:modified_time" content="2018-12-07T12:29:32.000Z">
<meta property="article:author" content="luoqian">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://vampireqian.github.io/2017/09/10/09python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%E3%80%81%E8%B7%AF%E5%BE%84%E5%A4%84%E7%90%86%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh","comments":true,"permalink":"https://vampireqian.github.io/2017/09/10/09python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%E3%80%81%E8%B7%AF%E5%BE%84%E5%A4%84%E7%90%86%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","path":"2017/09/10/09python文件处理、路径处理、序列化和反序列化/","title":"python-文件处理、路径处理、序列化和反序列化"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>python-文件处理、路径处理、序列化和反序列化 | luoqian</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="تشغيل شريط التصفح" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">luoqian</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          المحتويات
        </li>
        <li class="sidebar-nav-overview">
          عام
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6IO%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C"><span class="nav-number">1.</span> <span class="nav-text">文件IO常用操作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#open%E6%89%93%E5%BC%80%E6%93%8D%E4%BD%9C"><span class="nav-number">1.1.</span> <span class="nav-text">open打开操作</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mode%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.2.</span> <span class="nav-text">mode模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#seek%E6%96%87%E4%BB%B6%E6%8C%87%E9%92%88"><span class="nav-number">1.3.</span> <span class="nav-text">seek文件指针</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#buffering%E7%BC%93%E5%86%B2%E5%8C%BA"><span class="nav-number">1.4.</span> <span class="nav-text">buffering缓冲区</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%8F%82%E6%95%B0"><span class="nav-number">1.5.</span> <span class="nav-text">其他参数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#read%EF%BC%88%EF%BC%89"><span class="nav-number">1.6.</span> <span class="nav-text">read（）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#write%EF%BC%88%EF%BC%89"><span class="nav-number">1.7.</span> <span class="nav-text">write（）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#close%EF%BC%88%EF%BC%89"><span class="nav-number">1.8.</span> <span class="nav-text">close（）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">1.9.</span> <span class="nav-text">其他</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86"><span class="nav-number">1.10.</span> <span class="nav-text">上下文管理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#StringIO%E6%93%8D%E4%BD%9C"><span class="nav-number">2.</span> <span class="nav-text">StringIO操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BytesIO%E6%93%8D%E4%BD%9C"><span class="nav-number">3.</span> <span class="nav-text">BytesIO操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#file-like%E5%AF%B9%E8%B1%A1"><span class="nav-number">4.</span> <span class="nav-text">file-like对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%AF%E5%BE%84%E6%93%8D%E4%BD%9C"><span class="nav-number">5.</span> <span class="nav-text">路径操作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#os-path%E6%A8%A1%E5%9D%97"><span class="nav-number">5.1.</span> <span class="nav-text">os.path模块</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#pathlib%E6%A8%A1%E5%9D%97"><span class="nav-number">5.2.</span> <span class="nav-text">pathlib模块</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">5.2.1.</span> <span class="nav-text">操作符&#x2F;</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%86%E8%A7%A3"><span class="nav-number">5.2.2.</span> <span class="nav-text">分解</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#joinpath"><span class="nav-number">5.2.3.</span> <span class="nav-text">joinpath</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%B7%AF%E5%BE%84"><span class="nav-number">5.2.4.</span> <span class="nav-text">获取路径</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%88%B6%E7%9B%AE%E5%BD%95"><span class="nav-number">5.2.5.</span> <span class="nav-text">父目录</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E7%9A%84%E7%BB%84%E5%90%88%E9%83%A8%E5%88%86"><span class="nav-number">5.2.6.</span> <span class="nav-text">目录的组合部分</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E6%96%B9%E6%B3%95"><span class="nav-number">5.2.7.</span> <span class="nav-text">判断方法</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D"><span class="nav-number">5.2.8.</span> <span class="nav-text">匹配</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#pathlib%E6%A8%A1%E5%9D%97%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="nav-number">5.2.9.</span> <span class="nav-text">pathlib模块下的文件操作</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#csv%E6%96%87%E4%BB%B6"><span class="nav-number">6.</span> <span class="nav-text">csv文件</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#csv%E6%A8%A1%E5%9D%97"><span class="nav-number">6.1.</span> <span class="nav-text">csv模块</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ini%E6%96%87%E4%BB%B6"><span class="nav-number">7.</span> <span class="nav-text">ini文件</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#configparser%E6%A8%A1%E5%9D%97"><span class="nav-number">7.1.</span> <span class="nav-text">configparser模块</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-number">8.</span> <span class="nav-text">序列化和反序列化</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#pickle%E5%BA%93"><span class="nav-number">8.1.</span> <span class="nav-text">pickle库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%BA%94%E7%94%A8"><span class="nav-number">8.2.</span> <span class="nav-text">序列化的应用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Json"><span class="nav-number">8.3.</span> <span class="nav-text">Json</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#MessagePack"><span class="nav-number">8.4.</span> <span class="nav-text">MessagePack</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">luoqian</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">المقالات</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">التصنيفات</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">الوسوم</span>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://vampireqian.github.io/2017/09/10/09python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%E3%80%81%E8%B7%AF%E5%BE%84%E5%A4%84%E7%90%86%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="luoqian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="luoqian">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          python-文件处理、路径处理、序列化和反序列化
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">نُشر في</span>

      <time title="أُنشأ: 2017-09-10 00:00:00" itemprop="dateCreated datePublished" datetime="2017-09-10T00:00:00+08:00">2017-09-10</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">عُدل في</span>
        <time title="عُدل: 2018-12-07 20:29:32" itemprop="dateModified" datetime="2018-12-07T20:29:32+08:00">2018-12-07</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">في</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h4 id="文件IO常用操作"><a href="#文件IO常用操作" class="headerlink" title="文件IO常用操作"></a>文件IO常用操作</h4><p>一般说IO操作，指的是文件IO。</p>
<p>把文件存储到磁盘上的这个过程，叫做落地。</p>
<table>
<thead>
<tr>
<th align="center">column</th>
<th align="center">column</th>
</tr>
</thead>
<tbody><tr>
<td align="center">open</td>
<td align="center">打开</td>
</tr>
<tr>
<td align="center">read</td>
<td align="center">读取</td>
</tr>
<tr>
<td align="center">write</td>
<td align="center">写入</td>
</tr>
<tr>
<td align="center">close</td>
<td align="center">关闭</td>
</tr>
<tr>
<td align="center">readline</td>
<td align="center">行读取</td>
</tr>
<tr>
<td align="center">readlines</td>
<td align="center">多行读取</td>
</tr>
<tr>
<td align="center">seek</td>
<td align="center">文件指针操作</td>
</tr>
<tr>
<td align="center">tell</td>
<td align="center">指针位置</td>
</tr>
</tbody></table>
<h5 id="open打开操作"><a href="#open打开操作" class="headerlink" title="open打开操作"></a>open打开操作</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">open</span>(file, mode=<span class="string">&#x27;r&#x27;</span>, buffering=-<span class="number">1</span>, encoding=<span class="literal">None</span>, errors=<span class="literal">None</span>, newline=<span class="literal">None</span>, closefd=<span class="literal">True</span>,opener=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;file名字&quot;</span>)   <span class="comment">#文件对象</span></span><br><span class="line"><span class="built_in">print</span>(f.read())		<span class="comment">#读取文件</span></span><br><span class="line">f.close()		<span class="comment">#关闭文件</span></span><br></pre></td></tr></table></figure>

<p>打开一个文件，返回一个文件对象(流对象)和文件描述符。打开文件失败，则返回异常。<br>基本使用： 创建一个文件test，然后打开它，用完关闭。</p>
<p>文件操作中最常用的就是读和写。文件访问的模式有两种：文本模式和二进制模式。</p>
<blockquote>
<p>注：windows中使用codepage代码页。可以认为每一个代码页就是一张编码表 cp936和gbk等价。</p>
</blockquote>
<h5 id="mode模式"><a href="#mode模式" class="headerlink" title="mode模式"></a>mode模式</h5><table>
<thead>
<tr>
<th>描述字符</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>r</td>
<td>缺省的，表示只读打开</td>
</tr>
<tr>
<td>w</td>
<td>只写打开，有的话就清除重新写</td>
</tr>
<tr>
<td>x</td>
<td>创建并写入一个新文件</td>
</tr>
<tr>
<td>a</td>
<td>写入打开，如果文件存在，则追加</td>
</tr>
<tr>
<td>b</td>
<td>二进制模式</td>
</tr>
<tr>
<td>t</td>
<td>缺省的，文本模式</td>
</tr>
<tr>
<td>+</td>
<td>读写打开一个文件，给原来只读、只写的增加缺失的功能</td>
</tr>
</tbody></table>
<p>open默认是只读模式r打开已经存在的文件。</p>
<ul>
<li><p>r 只读打开文件，如果使用write方法，会抛异常。 如果文件不存在，抛出FileNotFoundError异常。</p>
</li>
<li><p>w 表示只写方式打开，如果读取则抛出异常 如果文件不存在，则直接创建文件 如果文件存在，则清空文件内容。</p>
</li>
<li><p>x 文件不存在，创建文件，并只写方式打开，文件存在，抛出FileExistsError异常。</p>
</li>
<li><p>a 文件存在，只写打开，追加内容 文件不存在，则创建后，只写打开，追加内容</p>
</li>
<li><p>r是只读，wxa都是只写。 wxa都可以产生新文件，w不管文件存在与否，都会生成全新内容的文件；a不管文件是否存在，都能在打开的文件尾部追加；x必须要求文件事先不存在，自己造一个新文件。</p>
</li>
<li><p>+为r、w、a、x提供缺失的读或写功能，但是，获取文件对象依旧按照r、w、a、x自己的特征。 +不能单独使用，可以认为它是为前面的模式字符做增强功能的。</p>
</li>
</ul>
<p>t和b：</p>
<ul>
<li><p>文本模式t 字符流，将文件的字节按照某种字符编码理解，按照字符操作。open的默认mode就是rt。</p>
</li>
<li><p>二进制模式b 字节流，将文件就按照字节理解，与字符编码无关。二进制模式操作时，字节操作使用bytes类型。</p>
</li>
</ul>
<p>t/b不能单独存在，要和a/w/x/r配合使用。</p>
<h5 id="seek文件指针"><a href="#seek文件指针" class="headerlink" title="seek文件指针"></a>seek文件指针</h5><p>文件指针，指向当前字节位置。</p>
<p>mode = r，指针起始在0  ，mode  =  a  指针起始在EOF。</p>
<p>tell（）：显示指针当前位置。</p>
<p>seek(offset[, whence]) 移动文件指针位置。offest偏移多少字节，whence从哪里开始。</p>
<ul>
<li><p>文本模式下 whence 0 缺省值，表示从头开始，offset只能正整数 whence 1 表示从当前位置，offset只接受0，whence 2 表示从EOF开始，offest只接受0</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 文本模式</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;test4&#x27;</span>,<span class="string">&#x27;r+&#x27;</span>)</span><br><span class="line">f.tell() <span class="comment"># 起始</span></span><br><span class="line">f.read()</span><br><span class="line">f.tell() <span class="comment"># EOF</span></span><br><span class="line">f.seek(<span class="number">0</span>) <span class="comment"># 起始</span></span><br><span class="line">f.read()</span><br><span class="line">f.seek(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line">f.read()</span><br><span class="line">f.seek(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line">f.seek(<span class="number">2</span>,<span class="number">1</span>) <span class="comment"># offset必须为0</span></span><br><span class="line">f.seek(<span class="number">2</span>,<span class="number">2</span>) <span class="comment"># offset必须为0</span></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></li>
<li><p>二进制模式下 whence 0 缺省值，表示从头开始，offest只能正整数 whence 1表示从当前位置，offest可正可负，whence 2 表示从EOF开始，offest可正可负。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 二进制模式</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;test4&#x27;</span>,<span class="string">&#x27;rb+&#x27;</span>)</span><br><span class="line">f.tell() <span class="comment"># 起始</span></span><br><span class="line">f.read()</span><br><span class="line">f.tell() <span class="comment"># EOF</span></span><br><span class="line">f.write(<span class="string">b&#x27;abc&#x27;</span>)</span><br><span class="line">f.seek(<span class="number">0</span>) <span class="comment"># 起始</span></span><br><span class="line">f.seek(<span class="number">2</span>,<span class="number">1</span>) <span class="comment"># 从当前指针开始，向后2</span></span><br><span class="line">f.read()</span><br><span class="line"> </span><br><span class="line">f.seek(-<span class="number">2</span>,<span class="number">2</span>) <span class="comment"># 从EOF开始，向前2</span></span><br><span class="line">f.read()</span><br><span class="line">f.seek(-<span class="number">20</span>,<span class="number">2</span>) <span class="comment"># OSError</span></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></li>
<li><p>二进制模式支持任意起点的偏移，从头、从尾、从中间位置开始。 向后seek可以超界，但是向前seek的时候，不能超界，否则抛异常。</p>
</li>
</ul>
<h5 id="buffering缓冲区"><a href="#buffering缓冲区" class="headerlink" title="buffering缓冲区"></a>buffering缓冲区</h5><p>-1 表示使用缺省大小的buffer。如果是二进制模式，使io.DEFAULT_BUFFER_SIZE值，默认是<font color= red>4096或者8192</font>。如果是文本模式，如果是终端设备，是行缓存方式，如果不是，则使用二进制模式的策略。</p>
<ul>
<li>0 只在二进制模式使用，表示关buffer</li>
<li>1 只在文本模式使用，表示使用行缓冲。意思就是见到换行符就flush</li>
<li>大于1 用于指定buffer的大小</li>
</ul>
<p>buffer 缓冲区 </p>
<p>缓冲区一个内存空间，一般来说是一个FIFO队列，到缓冲区满了或者达到阈值，数据才会flush到磁盘。</p>
<p>flush() 将缓冲区数据写入磁盘 close() 关闭前会调用flush()。</p>
<p>io.DEFAULT_BUFFER_SIZE 缺省缓冲区大小，字节。</p>
<table>
<thead>
<tr>
<th>buffering</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>buffering = -1</td>
<td>t和b，都是io.DEFAULT_BUFFER_SIZE</td>
</tr>
<tr>
<td>buffering = 0</td>
<td>b 关闭缓冲区 <br/>t 不支持</td>
</tr>
<tr>
<td>buffering = 1</td>
<td>b 就一个字节<br/>t 行缓冲，遇到换行符才flush</td>
</tr>
<tr>
<td>buffering &gt; 1</td>
<td>b模式表示行缓冲大小。缓冲区的值可以超过io.DEFAULT_BUFFER_SIZE，直到设定的值超出后才把缓冲区flush 。</td>
</tr>
<tr>
<td>t模式，是io.DEFAULT_BUFFER_SIZE字节，flush完后把当前字符串也写入磁盘</td>
<td></td>
</tr>
</tbody></table>
<p>一般来说：</p>
<ol>
<li>文本模式，一般都用默认缓冲区大小</li>
<li>二进制模式，是一个个字节的操作，可以指定buffer的大小</li>
<li>一般来说，默认缓冲区大小是个比较好的选择，除非明确知道，否则不调整它</li>
<li>一般编程中，明确知道需要写磁盘了，都会手动调用一次flush，而不是等到自动flush或者close的时候</li>
</ol>
<h5 id="其他参数"><a href="#其他参数" class="headerlink" title="其他参数"></a>其他参数</h5><p>编码：windows下缺省GBK（0xB0A1），Linux下缺省UTF-8（0xE5 95 8A）</p>
<p>errors ：编码错误将被捕获 None和strict表示有编码错误将抛出ValueError异常；ignore表示忽略</p>
<p>newline：文本模式中，换行的转换。可以为None、’’ 空串、’\r’、’\n’、’\r\n’ 。</p>
<ul>
<li>None表示’\r’、’\n’、’\r\n’都被转换为’\n’；</li>
<li>‘’  表示不会自动转换通用换行符；其它合法字符表示换行符就是指定字符，就会按照指定字符分行写。</li>
<li>‘\n’或’’表示’\n’不替换；其它合法字符表示’\n’会被替换为指定的字符</li>
</ul>
<p>closefd：关闭文件描述符，True表示关闭它。False会在文件关闭后保持这个描述符。fileobj.fileno()查看。</p>
<p><strong>文件描述符</strong>：Linux一切皆文件，文件打开后都会有一个位于的文件描述符，在计算机系统中是一个有限的资源。0,1,2,标准输入，标准输出，标准错误输出。</p>
<p>对于类似于文件对象的IO对象，一般来说都需要在不使用的时候关闭、注销，以释放资源。<br>IO被打开的时候，会获得一个文件描述符。计算机资源是有限的，所以操作系统都会做限制。就是为了保护计算机的资源不要被完全耗尽，计算资源是共享的，不是独占的。 </p>
<p>一般情况下，除非特别明确的知道资源情况，否则不要提高资源的限制值来解决问题。</p>
<h5 id="read（）"><a href="#read（）" class="headerlink" title="read（）"></a>read（）</h5><p>read(size=-1)<br>size表示读取的多少个字符或字节；负数或者None表示读取到EOF</p>
<p>readline(size=-1)<br>一行行读取文件内容。size设置一次能读取行内几个字符或字节。</p>
<p>readlines(hint=-1)<br>读取所有行的列表。指定hint则返回指定的行数。</p>
<h5 id="write（）"><a href="#write（）" class="headerlink" title="write（）"></a>write（）</h5><p>write(s)，把字符串s写入到文件中并返回字符的个数 writelines(lines)，将字符串列表写入文件。</p>
<h5 id="close（）"><a href="#close（）" class="headerlink" title="close（）"></a>close（）</h5><p>flush并关闭文件对象。<br>文件已经关闭，再次关闭没有任何效果。</p>
<h5 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h5><table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>seekable（）</td>
<td>是否可seek</td>
</tr>
<tr>
<td>readable（）</td>
<td>是否可读</td>
</tr>
<tr>
<td>writeable（）</td>
<td>是否可写</td>
</tr>
<tr>
<td>closed（）</td>
<td>是否已经关闭</td>
</tr>
</tbody></table>
<h5 id="上下文管理"><a href="#上下文管理" class="headerlink" title="上下文管理"></a>上下文管理</h5><p>1、异常处理<br>当出现异常的时候，拦截异常。但是，因为很多代码都可能出现OSError异常，还不好判断异常就是应为资源限制产生的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    f.write(<span class="string">&quot;abc&quot;</span>) <span class="comment"># 文件只读，写入失败</span></span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    f.close() <span class="comment"># 这样才行</span></span><br></pre></td></tr></table></figure>

<p>使用finally可以保证打开的文件可以被关闭。</p>
<p>上下文管理</p>
<ol>
<li><p>使用with … as 关键字</p>
</li>
<li><p>上下文管理的语句块并不会开启新的作用域</p>
</li>
<li><p>with语句块执行完的时候，会自动关闭文件对象</p>
</li>
</ol>
<h4 id="StringIO操作"><a href="#StringIO操作" class="headerlink" title="StringIO操作"></a>StringIO操作</h4><p>io模块中的类</p>
<pre><code>from io import StringIO
</code></pre>
<p>内存中，开辟的一个文本模式的buffer，可以像文件对象一样操作它</p>
<p>当close方法被调用的时候，这个buffer会被释放</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> StringIO</span><br><span class="line"><span class="comment"># 内存中构建</span></span><br><span class="line">sio = StringIO() <span class="comment"># 像文件对象一样操作</span></span><br><span class="line"><span class="built_in">print</span>(sio.readable(), sio.writable(), sio.seekable())<span class="comment"># True True True</span></span><br><span class="line">sio.write(<span class="string">&quot;luo\nPython&quot;</span>)</span><br><span class="line">sio.seek(<span class="number">0</span>)  </span><br><span class="line"><span class="built_in">print</span>(sio.readline())  <span class="comment">#magedu</span></span><br><span class="line"><span class="built_in">print</span>(sio.getvalue()) <span class="comment"># 无视指针，输出全部内容  magedu   Python</span></span><br><span class="line">sio.close()</span><br></pre></td></tr></table></figure>

<p>好处</p>
<pre><code>一般来说，磁盘的操作比内存的操作要慢得多，内存足够的情况下，一般的思路是少落地，减少磁盘IO的过程，可以大大的提高程序的运行效率。
</code></pre>
<h4 id="BytesIO操作"><a href="#BytesIO操作" class="headerlink" title="BytesIO操作"></a>BytesIO操作</h4><p>io模块中的类</p>
<pre><code>from io import BytesIO
</code></pre>
<p>内存中，开辟的一个二进制模式的buffer，可以像文件对象一样操作它</p>
<p>当close方法被调用的时候，这个buffer会被释放</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO <span class="comment"># 内存中构建</span></span><br><span class="line">bio = BytesIO()</span><br><span class="line"><span class="built_in">print</span>(bio.readable(), bio.writable(), bio.seekable()) <span class="comment">#True True True</span></span><br><span class="line">bio.write(<span class="string">b&quot;luo\nPython&quot;</span>)</span><br><span class="line">bio.seek(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(bio.readline())  <span class="comment"># b&#x27;magedu\n&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(bio.getvalue()) <span class="comment"># 无视指针，输出全部内容   b&#x27;magedu\nPython&#x27;</span></span><br><span class="line">bio.close()</span><br></pre></td></tr></table></figure>

<h4 id="file-like对象"><a href="#file-like对象" class="headerlink" title="file-like对象"></a>file-like对象</h4><p>类文件对象，可以像文件对象一样操作。</p>
<p>socket对象，输入输出对象（stdin、stdout）都是类文件对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> stdout, stderr</span><br><span class="line">f = stdout</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(f))  <span class="comment">#&lt;class &#x27;ipykernel.iostream.OutStream&#x27;&gt;</span></span><br><span class="line">f.write(<span class="string">&#x27;magedu.com&#x27;</span>)  <span class="comment">#magedu.com</span></span><br></pre></td></tr></table></figure>

<h4 id="路径操作"><a href="#路径操作" class="headerlink" title="路径操作"></a>路径操作</h4><h5 id="os-path模块"><a href="#os-path模块" class="headerlink" title="os.path模块"></a>os.path模块</h5><p>3.4版本之前</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> path</span><br><span class="line">p = path.join(<span class="string">&#x27;d:/&#x27;</span>,<span class="string">&#x27;tmp&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(p), p)               <span class="comment">#&lt;class &#x27;str&#x27;&gt; d:/tmp</span></span><br><span class="line"><span class="built_in">print</span>(path.exists(p))     <span class="comment">#判断是否存在该路径  True</span></span><br><span class="line"><span class="built_in">print</span>(path.split(p)) <span class="comment"># (head,tail)     (&#x27;d:/&#x27;, &#x27;tmp&#x27;)</span></span><br><span class="line"><span class="built_in">print</span>(path.abspath(<span class="string">&#x27;.&#x27;</span>))   <span class="comment"># 打印当前的绝对路径      C:\Users\vampire\python</span></span><br><span class="line">p = path.join(<span class="string">&#x27;D:/&#x27;</span>, p, <span class="string">&#x27;test.txt&#x27;</span>)   <span class="comment">#  &#x27;d:/tmp\\test.txt&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(path.dirname(p)) <span class="comment"># 目录名</span></span><br><span class="line"><span class="built_in">print</span>(path.basename(p)) <span class="comment">#基名，就是文件名</span></span><br><span class="line"><span class="built_in">print</span>(path.splitdrive(p)) <span class="comment">#二元组  (&#x27;d:&#x27;, &#x27;/tmp\\test.txt&#x27;）</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">p1 = path.abspath(<span class="string">&quot;.&quot;</span>)  <span class="comment">#“文件路径”</span></span><br><span class="line"><span class="built_in">print</span>(p1, path.basename(p1))</span><br><span class="line"><span class="keyword">while</span> p1 != path.dirname(p1):</span><br><span class="line">    p1 = path.dirname(p1)</span><br><span class="line">    <span class="built_in">print</span>(p1, path.basename(p1))</span><br><span class="line"></span><br><span class="line">​```</span><br><span class="line">C:\Users\vampire\python python</span><br><span class="line">C:\Users\vampire vampire</span><br><span class="line">C:\Users Users</span><br><span class="line">C:\ </span><br><span class="line">​```</span><br></pre></td></tr></table></figure>

<h5 id="pathlib模块"><a href="#pathlib模块" class="headerlink" title="pathlib模块"></a>pathlib模块</h5><p>提供Path对象来操作。包括目录和文件。</p>
<p>导入模块：from pathlib import Path</p>
<p><strong>目录操作初始化</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p = Path() <span class="comment"># 当前目录    WindowsPath(&#x27;.&#x27;)</span></span><br><span class="line">p.absolute()<span class="comment">#   WindowsPath(&#x27;C:/Users/vampire/python&#x27;)</span></span><br><span class="line">p = Path(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c/d&#x27;</span>) <span class="comment"># 当前目录下的 WindowsPath(&#x27;C:/Users/vampire/python/a/b/c/d&#x27;)</span></span><br><span class="line">p = Path(<span class="string">&#x27;/etc&#x27;</span>) <span class="comment"># 根下的etc目录</span></span><br></pre></td></tr></table></figure>

<p><strong>路径拼接和分解</strong></p>
<h6 id="操作符"><a href="#操作符" class="headerlink" title="操作符/"></a>操作符/</h6><p>Path对象 / Path对象<br>Path对象 / 字符串 或者 字符串 / Path对象 </p>
<h6 id="分解"><a href="#分解" class="headerlink" title="分解"></a>分解</h6><p>parts属性，可以返回路径中的每一个部分 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p3.absolute()   <span class="comment">#WindowsPath(&#x27;C:/Users/vampire/python/c/a&#x27;)</span></span><br><span class="line">p3.absolute().parts   <span class="comment">#(&#x27;C:\\&#x27;, &#x27;Users&#x27;, &#x27;vampire&#x27;, &#x27;python&#x27;, &#x27;c&#x27;, &#x27;a&#x27;)</span></span><br></pre></td></tr></table></figure>

<h6 id="joinpath"><a href="#joinpath" class="headerlink" title="joinpath"></a>joinpath</h6><p>joinpath(*other) 连接多个字符串到Path对象中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p = Path()   <span class="comment">#   WindowsPath(&#x27;.&#x27;)</span></span><br><span class="line">p = p / <span class="string">&#x27;a&#x27;</span>   <span class="comment">#  WindowsPath(&#x27;a&#x27;)</span></span><br><span class="line">p.absolute()  <span class="comment">#   WindowsPath(&#x27;C:/Users/vampire/python/a&#x27;)</span></span><br><span class="line">p1 = <span class="string">&#x27;b&#x27;</span> / p  <span class="comment">#   WindowsPath(&#x27;C:/Users/vampire/python/b/a&#x27;)</span></span><br><span class="line">p2 = Path(<span class="string">&#x27;c&#x27;</span>) <span class="comment">#  WindowsPath(&#x27;C:/Users/vampire/python/c&#x27;)</span></span><br><span class="line">p2.absolute()  <span class="comment">#   WindowsPath(&#x27;C:/Users/vampire/python/c&#x27;)</span></span><br><span class="line">p3 = p2 / p1  <span class="comment">#  WindowsPath(&#x27;c/b/a&#x27;)</span></span><br><span class="line">p3.absolute()  <span class="comment">#  WindowsPath(&#x27;C:/Users/vampire/python/c/b/a&#x27;)</span></span><br><span class="line"><span class="built_in">print</span>(p3.parts)   <span class="comment">#</span></span><br><span class="line">p3.absolute().parts <span class="comment"># (&#x27;C:\\&#x27;, &#x27;Users&#x27;, &#x27;vampire&#x27;, &#x27;python&#x27;, &#x27;c&#x27;, &#x27;b&#x27;, &#x27;a&#x27;)</span></span><br><span class="line">p3.joinpath(<span class="string">&#x27;etc&#x27;</span>,<span class="string">&#x27;init.d&#x27;</span>,Path(<span class="string">&#x27;httpd&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h6 id="获取路径"><a href="#获取路径" class="headerlink" title="获取路径"></a>获取路径</h6><p>str 获取路径字符串 </p>
<p>bytes 获取路径字符串的bytes </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p = Path(<span class="string">&#x27;/etc&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(p), <span class="built_in">bytes</span>(p))</span><br><span class="line"></span><br><span class="line"><span class="comment">#  \etc   b&#x27;\\etc&#x27;</span></span><br></pre></td></tr></table></figure>

<h6 id="父目录"><a href="#父目录" class="headerlink" title="父目录"></a>父目录</h6><p>parent 目录的逻辑父目录 </p>
<p>parents 父目录序列，索引0是直接的父 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">p = Path(<span class="string">&#x27;/a/b/c/d&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p.absolute())   <span class="comment">#C:\a\b\c\d</span></span><br><span class="line"><span class="built_in">print</span>(p.parent.parent)  <span class="comment">#\a\b</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> p.parents:</span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line">    </span><br><span class="line"><span class="comment">#\a\b\c</span></span><br><span class="line"><span class="comment">#\a\b</span></span><br><span class="line"><span class="comment">#\a</span></span><br><span class="line"><span class="comment">#\</span></span><br></pre></td></tr></table></figure>

<h6 id="目录的组合部分"><a href="#目录的组合部分" class="headerlink" title="目录的组合部分"></a>目录的组合部分</h6><p>name、stem、suffix、suffixes、with_suffix(suffix)、with_name(name) </p>
<p>name 目录的最后一个部分 </p>
<p>suffix 目录中最后一个部分的扩展名 </p>
<p>stem 目录最后一个部分，没有后缀 </p>
<p>suffixes 返回多个扩展名列表 </p>
<p>with_suffix(suffix) 有扩展名则替换，无则补充扩展名 </p>
<p>with_name(name) 替换目录最后一个部分并返回一个新的路径</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">p = Path(<span class="string">&#x27;mysqlinstall/mysql.tar.gz&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p.name)   <span class="comment">#mysql.tar.gz</span></span><br><span class="line"><span class="built_in">print</span>(p.suffix)  <span class="comment">#.gz</span></span><br><span class="line"><span class="built_in">print</span>(p.suffixes)  <span class="comment"># [&#x27;.tar&#x27;, &#x27;.gz&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(p.stem)   <span class="comment"># mysql.tar</span></span><br><span class="line"><span class="built_in">print</span>(p.with_name(<span class="string">&#x27;mysql-5.tgz&#x27;</span>))   <span class="comment">#\mysqlinstall\mysql-5.tgz</span></span><br><span class="line"><span class="built_in">print</span>(p.with_suffix(<span class="string">&#x27;.png&#x27;</span>))   <span class="comment">#\mysqlinstall\mysql.tar.png</span></span><br><span class="line">p = Path(<span class="string">&#x27;README&#x27;</span>)  <span class="comment">#  README</span></span><br><span class="line"><span class="built_in">print</span>(p.with_suffix(<span class="string">&#x27;.txt&#x27;</span>))   <span class="comment">#  README.txt</span></span><br></pre></td></tr></table></figure>

<h6 id="判断方法"><a href="#判断方法" class="headerlink" title="判断方法"></a>判断方法</h6><p><code>is_dir()</code> 是否是目录，目录存在返回True </p>
<p><code>is_file()</code> 是否是普通文件，文件存在返回True </p>
<p><code>is_symlink()</code> 是否是软链接 </p>
<p><code>is_socket() </code>是否是socket文件 </p>
<p><code>is_block_device() </code>是否是块设备 </p>
<p><code>is_char_device()</code> 是否是字符设备 </p>
<p><code>is_absolute() </code>是否是绝对路径</p>
<p><code>resolve() </code>返回一个新的路径，这个新路径就是当前Path对象的绝对路径，如果是软链接则直接被解析 </p>
<p><code>absolute()</code> 获取绝对路径</p>
<p><code>exists() </code>目录或文件是否存在 </p>
<p><code>rmdir() </code>删除空目录。没有提供判断目录为空的方法 </p>
<p><code>touch(mode=0o666, exist_ok=True)</code> 创建一个文件 </p>
<p><code>as_uri()</code> 将路径返回成URI，例如’file:///etc/passwd’</p>
<p><code>mkdir(mode=0o777, parents=False, exist_ok=False) </code></p>
<ul>
<li><p>parents，是否创建父目录，True等同于mkdir -p；False时，父目录不存在，则抛出FileNotFoundError </p>
</li>
<li><p>exist_ok参数，在3.5版本加入。False时，路径存在，抛出FileExistsError；True时，FileExistsError被忽略</p>
</li>
</ul>
<p><code>iterdir() </code>迭代当前目录</p>
<h6 id="匹配"><a href="#匹配" class="headerlink" title="匹配"></a>匹配</h6><p>match（pattern）</p>
<p>模式匹配，成功返回True。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Path(<span class="string">&#x27;a/b.py&#x27;</span>).match(<span class="string">&#x27;*.py&#x27;</span>) <span class="comment"># True</span></span><br><span class="line">Path(<span class="string">&#x27;/a/b/c.py&#x27;</span>).match(<span class="string">&#x27;b/*.py&#x27;</span>) <span class="comment"># True</span></span><br><span class="line">Path(<span class="string">&#x27;/a/b/c.py&#x27;</span>).match(<span class="string">&#x27;a/*.py&#x27;</span>) <span class="comment"># False</span></span><br><span class="line">Path(<span class="string">&#x27;/a/b/c.py&#x27;</span>).match(<span class="string">&#x27;a/*/*.py&#x27;</span>) <span class="comment"># True</span></span><br><span class="line">Path(<span class="string">&#x27;/a/b/c.py&#x27;</span>).match(<span class="string">&#x27;a/**/*.py&#x27;</span>) <span class="comment"># True</span></span><br><span class="line">Path(<span class="string">&#x27;/a/b/c.py&#x27;</span>).match(<span class="string">&#x27;**/*.py&#x27;</span>) <span class="comment"># True</span></span><br></pre></td></tr></table></figure>

<p>stat()  相当于stat命令  ，lstat() 同stat()，但如果是符号链接，则显示符号链接本身的文件信息</p>
<h6 id="pathlib模块下的文件操作"><a href="#pathlib模块下的文件操作" class="headerlink" title="pathlib模块下的文件操作"></a>pathlib模块下的文件操作</h6><p><code>Path.open(mode=&#39;r&#39;, buffering=-1, encoding=None, errors=None, newline=None)</code></p>
<p>使用的方法类似内建函数open，返回一个文件对象。</p>
<p>3.5增加的新函数 </p>
<p><code>Path.read_bytes()  </code></p>
<p>以’rb’读取路径对应文件，并返回二进制流。看源码</p>
<p><code>Path.read_text(encoding=None, errors=None) </code></p>
<p>以’rt’方式读取路径对应文件，返回文本。</p>
<p><code>Path.write_bytes(data)  </code></p>
<p>以’wb’方式写入数据到路径对应文件。</p>
<p><code>Path.write_text(data, encoding=None, errors=None) </code></p>
<p>以’wt’方式写入字符串到路径对应文件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">p = Path(<span class="string">&#x27;my_binary_file&#x27;</span>)</span><br><span class="line">p.write_bytes(<span class="string">b&#x27;Binary file contents&#x27;</span>)</span><br><span class="line">p.read_bytes() <span class="comment"># b&#x27;Binary file contents&#x27;</span></span><br><span class="line"> </span><br><span class="line">p = Path(<span class="string">&#x27;my_text_file&#x27;</span>)</span><br><span class="line">p.write_text(<span class="string">&#x27;Text file contents&#x27;</span>)</span><br><span class="line">p.read_text() <span class="comment"># &#x27;Text file contents&#x27;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line">p = Path(<span class="string">&#x27;o:/test.py&#x27;</span>)</span><br><span class="line">p.write_text(<span class="string">&#x27;hello python&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p.read_text())</span><br><span class="line"><span class="keyword">with</span> p.<span class="built_in">open</span>() <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(f.read(<span class="number">5</span>))</span><br></pre></td></tr></table></figure>

<h4 id="csv文件"><a href="#csv文件" class="headerlink" title="csv文件"></a>csv文件</h4><p>逗号分隔值Comma-Separated Values。 </p>
<p>CSV 是一个被行分隔符、列分隔符划分成行和列的文本文件。 </p>
<p>CSV 不指定字符编码。</p>
<p>行分隔符为\r\n，最后一行可以没有换行符 </p>
<p>列分隔符常为逗号或者制表符。 </p>
<p>每一行称为一条记录record </p>
<p>字段可以使用双引号括起来，也可以不使用。如果字段中出现了双引号、逗号、换行符必须使用双引号括起来。如果字段的值是双引号，使用两个双引号表示一个转义。</p>
<p>表头可选，和字段列对齐就行了。</p>
<p>手动生成csv文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">p = Path(<span class="string">&#x27;D:/tmp/test.csv&#x27;</span>)</span><br><span class="line">parent = p.parent</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> parent.exists():</span><br><span class="line">    parent.mkdir(parents=<span class="literal">True</span>,exist_ok =<span class="literal">True</span>) <span class="comment">#exist_ok 用在python3.5之后，如果文件目录存在，True则压制异常。</span></span><br><span class="line">csv_body = <span class="string">&#x27;&#x27;&#x27;\</span></span><br><span class="line"><span class="string">id,name,age,comment</span></span><br><span class="line"><span class="string">1,zs,18,&quot;I&#x27;m 18&quot;</span></span><br><span class="line"><span class="string">2,ls,20,&quot;this is a &quot;&quot;test&quot;&quot; string.&quot;</span></span><br><span class="line"><span class="string">3,ww,23,&quot;你好</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">计算机</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">p.write_text(csv_body)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="csv模块"><a href="#csv模块" class="headerlink" title="csv模块"></a>csv模块</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reader</span>(<span class="params">iterable, dialect=<span class="string">&#x27;excel&#x27;</span>, *args, **kwargs</span>)</span></span><br></pre></td></tr></table></figure>

<p>返回一个reader对象，是一个行迭代器</p>
<p>默认使用excel方言，如下：</p>
<ul>
<li><p>delimiter 列分隔符,逗号</p>
</li>
<li><p>lineterminator 行分隔符\r\n</p>
</li>
<li><p>quotechar 字段的引用符号，缺省为”双引号</p>
</li>
<li><p>双引号的处理</p>
<ul>
<li>doublequote 双引号的处理，默认为True。如果碰到数据中有双引号，而quotechar也是双引号，True则使用2个双引号表示，False表示使用转义字符将作为双引号的前缀。</li>
<li>escapechar 一个转义字符，默认为None</li>
<li>writer = csv.writer(f, doublequote=False, escapechar=‘@’) 遇到双引号，则必须提供转义字符</li>
</ul>
</li>
<li><p>quoting 指定双引号的规则</p>
<ul>
<li><p>QUOTE_ALL 所有字段</p>
</li>
<li><p>QUOTE_MINIMAL特殊字符字段，Excel方言使用该规则</p>
</li>
<li><p>QUOTE_NONNUMERIC非数字字段</p>
</li>
<li><p>QUOTE_NONE都不使用引号。</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">writer</span>(<span class="params">fileobj, dialect=<span class="string">&#x27;excel&#x27;</span>, *args, **kwargs</span>)</span></span><br></pre></td></tr></table></figure>

<p>返回DictWriter实例，主要的方法有writerow，writerows。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"> </span><br><span class="line">p = Path(<span class="string">&#x27;d://tmp/tesr.csv&#x27;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="built_in">str</span>(p)) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)    <span class="comment">#返回一个迭代对象</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">next</span>(reader))     <span class="comment">#不回头</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">next</span>(reader))     </span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> reader:</span><br><span class="line">        <span class="built_in">print</span>(line)</span><br><span class="line"> </span><br><span class="line">rows = [</span><br><span class="line">    [<span class="number">4</span>,<span class="string">&#x27;tom&#x27;</span>,<span class="number">22</span>,<span class="string">&#x27;tom&#x27;</span>],</span><br><span class="line">    (<span class="number">5</span>,<span class="string">&#x27;jerry&#x27;</span>,<span class="number">24</span>,<span class="string">&#x27;jerry&#x27;</span>),</span><br><span class="line">    (<span class="number">6</span>,<span class="string">&#x27;justin&#x27;</span>,<span class="number">22</span>,<span class="string">&#x27;just\t&quot;in&#x27;</span>),</span><br><span class="line">    <span class="string">&quot;abcdefghi&quot;</span>,</span><br><span class="line">    ((<span class="number">1</span>,),(<span class="number">2</span>,))</span><br><span class="line">]</span><br><span class="line">row = rows[<span class="number">0</span>]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="built_in">str</span>(p), <span class="string">&#x27;a&#x27;</span>,newline=<span class="string">&quot;&quot;</span>) <span class="keyword">as</span> f:  <span class="comment">#newline为了不换行</span></span><br><span class="line">    writer = csv.writer(f)</span><br><span class="line">    writer.writerow(row)   <span class="comment">#一次写一条</span></span><br><span class="line">    writer.writerows(rows)    <span class="comment">#将所有的一次写入</span></span><br></pre></td></tr></table></figure>

<h4 id="ini文件"><a href="#ini文件" class="headerlink" title="ini文件"></a>ini文件</h4><p>一般作为配置文件。</p>
<p>ini文件：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[DEFAULT]</span></span><br><span class="line"><span class="attr">a</span> = test</span><br><span class="line"> </span><br><span class="line"><span class="section">[mysql]</span></span><br><span class="line"><span class="attr">default-character-set</span>=utf8</span><br><span class="line"> </span><br><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">datadir</span> =/dbserver/data</span><br><span class="line"><span class="attr">port</span> = <span class="number">33060</span></span><br><span class="line"><span class="attr">character-set-server</span>=utf8</span><br><span class="line"><span class="attr">sql_mode</span>=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES</span><br></pre></td></tr></table></figure>

<p>中括号里面的部分称为section，译作节、区、段。 </p>
<p>每一个section内，都是key=value形成的键值对，key称为option选项。</p>
<p>这里的DEFAULT是缺省section的名字，必须大写。</p>
<h5 id="configparser模块"><a href="#configparser模块" class="headerlink" title="configparser模块"></a>configparser模块</h5><p>configparser模块的ConfigParser类就是用来操作。</p>
<p>可以将section当做key，section存储着键值对组成的字典，可以把ini配置文件当做一个嵌套的字典。默认使用的是有序字典。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">read(filenames, encoding=<span class="literal">None</span>) </span><br><span class="line"><span class="comment">#读取ini文件，可以是单个文件，也可以是文件列表。可以指定文件编码。</span></span><br><span class="line">sections()  <span class="comment">#返回section列表。缺省section不包括在内。 </span></span><br><span class="line">add_section(section_name)   <span class="comment">#增加一个section。 </span></span><br><span class="line"></span><br><span class="line">has_section(section_name)   <span class="comment">#判断section是否存在 </span></span><br><span class="line">options(section)   <span class="comment">#返回section的所有option，会追加缺省section的option </span></span><br><span class="line"></span><br><span class="line">has_option(section, option)  <span class="comment">#判断section是否存在这个option</span></span><br><span class="line">get(section, option, *, raw=<span class="literal">False</span>, <span class="built_in">vars</span>=<span class="literal">None</span>[, fallback]) </span><br><span class="line"></span><br><span class="line"><span class="comment">#从指定的段的选项上取值，如果找到返回，如果没有找到就去找DEFAULT段有没有。</span></span><br><span class="line"></span><br><span class="line">getint(section, option, *, raw=<span class="literal">False</span>, <span class="built_in">vars</span>=<span class="literal">None</span>[, fallback]) </span><br><span class="line">getfloat(section, option, *, raw=<span class="literal">False</span>, <span class="built_in">vars</span>=<span class="literal">None</span>[, fallback]) </span><br><span class="line">getboolean(section, option, *, raw=<span class="literal">False</span>, <span class="built_in">vars</span>=<span class="literal">None</span>[, fallback]) </span><br><span class="line"><span class="comment">#上面3个方法和get一样，返回指定类型数据。</span></span><br><span class="line"></span><br><span class="line">items(raw=<span class="literal">False</span>, <span class="built_in">vars</span>=<span class="literal">None</span>) </span><br><span class="line">items(section, raw=<span class="literal">False</span>, <span class="built_in">vars</span>=<span class="literal">None</span>) </span><br><span class="line"><span class="comment">#没有section，则返回所有section名字及其对象；如果指定section，则返回这个指定的section的键值对组成二元组。</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>(section, option, value) </span><br><span class="line"><span class="comment">#section存在的情况下，写入option=value，要求option、value必须是字符串。</span></span><br><span class="line"></span><br><span class="line">remove_section(section) </span><br><span class="line"><span class="comment">#移除section及其所有option </span></span><br><span class="line"></span><br><span class="line">remove_option(section, option) </span><br><span class="line"><span class="comment">#移除section下的option。</span></span><br><span class="line"></span><br><span class="line">write(fileobject, space_around_delimiters=<span class="literal">True</span>) </span><br><span class="line"><span class="comment">#将当前config的所有内容写入fileobject中，一般open函数使用w模式。</span></span><br></pre></td></tr></table></figure>
<p>代码示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> configparser <span class="keyword">import</span> ConfigParser</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">filename = Path(<span class="string">&quot;d://tmp/mysql.ini&quot;</span>)</span><br><span class="line">newfilename = Path(<span class="string">&quot;d://tmp/mysql111.ini&quot;</span>)</span><br><span class="line"></span><br><span class="line">cfg = ConfigParser()</span><br><span class="line">read_ok = cfg.read(<span class="built_in">str</span>(filename))</span><br><span class="line"><span class="built_in">print</span>(read_ok)</span><br><span class="line"><span class="built_in">print</span>(cfg.sections())</span><br><span class="line"><span class="built_in">print</span>(cfg.has_section(<span class="string">&quot;mysql&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> cfg.items():   <span class="comment">#未指定section</span></span><br><span class="line">    <span class="built_in">print</span>(k,<span class="built_in">type</span>(k))</span><br><span class="line">    <span class="built_in">print</span>(v,<span class="built_in">type</span>(v))</span><br><span class="line">    <span class="built_in">print</span>(cfg.items(k))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;~~~~~~~~~~~~~~~~~~&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> cfg.items(<span class="string">&quot;mysqld&quot;</span>):  <span class="comment">#指定section</span></span><br><span class="line">    <span class="built_in">print</span>(k,<span class="built_in">type</span>(k))</span><br><span class="line">    <span class="built_in">print</span>(v,<span class="built_in">type</span>(v))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;~~~~~~~~~~&quot;</span>)</span><br><span class="line"></span><br><span class="line">tmp = cfg.get(<span class="string">&quot;mysqld&quot;</span>,<span class="string">&quot;port&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(tmp, <span class="built_in">type</span>(tmp))</span><br><span class="line"><span class="built_in">print</span>(cfg.get(<span class="string">&quot;mysqld&quot;</span>, <span class="string">&quot;a&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(cfg.get(<span class="string">&quot;mysqld&quot;</span>, <span class="string">&quot;python&quot;</span> , fallback= <span class="string">&quot;linux&quot;</span>))  <span class="comment">#按照类型，fallbac：给与缺省值</span></span><br><span class="line"></span><br><span class="line">tmp = cfg.getint(<span class="string">&quot;mysqld&quot;</span>, <span class="string">&quot;port&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(tmp), tmp)</span><br><span class="line"></span><br><span class="line">cfg.add_section(<span class="string">&quot;test&quot;</span>)</span><br><span class="line">cfg.<span class="built_in">set</span>(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;test1&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">cfg.<span class="built_in">set</span>(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;test2&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(newfilename,<span class="string">&quot;w+&quot;</span>,newline=<span class="string">&quot;&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    cfg.write(f)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cfg.getint(<span class="string">&quot;test&quot;</span> , <span class="string">&quot;test1&quot;</span>))</span><br><span class="line"></span><br><span class="line">cfg.remove_option(<span class="string">&quot;test&quot;</span>, <span class="string">&quot;test1&quot;</span>)</span><br><span class="line"><span class="comment"># cfg.remove_section(&quot;test&quot;)</span></span><br><span class="line"><span class="comment"># print(&quot;x&quot; in cfg[&quot;test2&quot;])</span></span><br><span class="line"><span class="comment">#字典操作</span></span><br><span class="line">cfg[<span class="string">&quot;test3&quot;</span>] = &#123;<span class="string">&quot;c&quot;</span>:<span class="string">&quot;1000&quot;</span>&#125;   <span class="comment">#没有落地，在内存中修改</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;x&quot;</span> <span class="keyword">in</span> cfg[<span class="string">&quot;test&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c&quot;</span> <span class="keyword">in</span> cfg[<span class="string">&quot;test3&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 其他内部方式</span></span><br><span class="line"><span class="built_in">print</span>(cfg._<span class="built_in">dict</span>)  <span class="comment"># 返回默认的字典类型，默认使用有序字典</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> cfg._sections.items():</span><br><span class="line">    <span class="built_in">print</span>(k, v)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> cfg._sections[<span class="string">&#x27;mysqld&#x27;</span>].items():</span><br><span class="line">    <span class="built_in">print</span>(k,v)</span><br><span class="line"><span class="comment">#重新写入文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(newfilename, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    cfg.write(f)</span><br></pre></td></tr></table></figure>



<h4 id="序列化和反序列化"><a href="#序列化和反序列化" class="headerlink" title="序列化和反序列化"></a>序列化和反序列化</h4><pre><code>要设计一套协议，按照某种规则，把内存中数据保存到文件中，文件是一个字节序列，所以必须把数据转换成&lt;font color=red &gt;字节&lt;/font&gt;序列，输出到文件。这就是序列化。反之，从文件的字节序列恢复到内存。就是反序列化。
</code></pre>
<ol>
<li><p>serialization：序列化<br>将内存中对象存储下来，变成一个个字节 –&gt;  二进制</p>
</li>
<li><p>deseiralization：反序列化<br>将文件中的一个个字节恢复成内存中对象   &lt;–二进制</p>
</li>
</ol>
<p>序列化保存到文件就是持久化，可以将数据序列化后持久化，或者网络传输；也可以将文件中或者网络中接收到的字节序列反序列化。</p>
<h5 id="pickle库"><a href="#pickle库" class="headerlink" title="pickle库"></a>pickle库</h5><p>python中的序列化，反序列化模块。</p>
<p>dumps  对象序列化为bytes对象      dump   对象序列化到文件对象，就是存入文件</p>
<p>loads 从bytes对象反序列化     load  对象反序列化，从文件读取数据</p>
<h5 id="序列化的应用"><a href="#序列化的应用" class="headerlink" title="序列化的应用"></a>序列化的应用</h5><p>一般来说，本地序列化的情况，应用较少。大多数场景都应用在网络传输中。 </p>
<p>将数据序列化后通过网络传输到远程节点，远程服务器上的服务将接收到的数据反序列化后，就可以使用了。 </p>
<p>但是，要注意一点，远程接收端，反序列化时必须有对应的数据类型，否则就会报错。尤其是自定义类，必须远程的有一致的定义。</p>
<p>现在，大多数项目，都不是单机的，也不是单服务的。需要通过网络将数据传送到其他节点上去，这就需要大量的序列化、反序列化过程。</p>
<p>但是，问题是，Python程序之间还可以都是用pickle解决序列化、反序列化，如果是跨平台、跨语言、跨协议pickle就不太适合了，就需要公共的协议。例如XML、Json、Protocol Buffer等。</p>
<p>不同的协议，效率不同、学习曲线不同，适用不同场景，要根据不同的情况分析选型。</p>
<h5 id="Json"><a href="#Json" class="headerlink" title="Json"></a>Json</h5><pre><code>Json(JavaScript Object Notation，JS对象标记)是一种轻量级的数据交换格式。它基于 ECMAScript (w3c组织制定的JS规范)的一个子集，采用完全独立于编程语言的文本格式来存储和表示数据。网址: http://json.org/
</code></pre>
<p>Json的数据类型</p>
<p>值：双引号引起来的字符串，数值，true和false，null，对象，数组，这些都是值 </p>
<p>字符串：有正负，有整数，浮点数。</p>
<p>对象：无序的键值对的集合，格式{key:value…}，key必须是一个字符串，需要双引号包围这个字符串，value可以是任意合法的值。</p>
<p>数组：有序的值的集合  格式[val1，，，，valn]</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;person&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;tom&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;age&quot;</span>: <span class="number">18</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;jerry&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;age&quot;</span>: <span class="number">16</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;total&quot;</span>: <span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Json模块</p>
<p>Python支持少量内建数据类型到Json类型的转换</p>
<table>
<thead>
<tr>
<th>Python类型</th>
<th>Json类型</th>
</tr>
</thead>
<tbody><tr>
<td>True</td>
<td>true</td>
</tr>
<tr>
<td>False</td>
<td>false</td>
</tr>
<tr>
<td>None</td>
<td>null</td>
</tr>
<tr>
<td>str</td>
<td>string</td>
</tr>
<tr>
<td>int</td>
<td>integer</td>
</tr>
<tr>
<td>float</td>
<td>float</td>
</tr>
<tr>
<td>list</td>
<td>array</td>
</tr>
<tr>
<td>dict</td>
<td>object</td>
</tr>
</tbody></table>
<p>常用方法</p>
<table>
<thead>
<tr>
<th>Python类型</th>
<th>Json类型</th>
</tr>
</thead>
<tbody><tr>
<td>dumps</td>
<td>Json编码</td>
</tr>
<tr>
<td>dump</td>
<td>Json编码并存入文件</td>
</tr>
<tr>
<td>loads</td>
<td>Json解码</td>
</tr>
<tr>
<td>load</td>
<td>Json解码，从文件读取数据</td>
</tr>
</tbody></table>
<p>一般Json编码的数据很少落地，数据都是通过网络传输，传输的时候，要考虑压缩它，节省流量。本质来说它就是个文本，就是个字符串。</p>
<h5 id="MessagePack"><a href="#MessagePack" class="headerlink" title="MessagePack"></a>MessagePack</h5><p>MessagePack是一个基于二进制高效的对象序列化类库，可用于跨语言通信。 </p>
<p>它可以像JSON那样，在许多种语言之间交换结构对象。 </p>
<p>兼容 json和pickle。</p>
<p>MessagePack简单易用，高效压缩，支持语言丰富。 </p>
<p>所以，用它序列化也是一种很好的选择。</p>
<p>安装：$pip install msgpack-python</p>
<p>常用方法：</p>
<p>packb 序列化对象。提供了dumps来兼容pickle和json。 </p>
<p>unpackb 反序列化对象。提供了loads来兼容。</p>
<p>pack 序列化对象保存到文件对象。提供了dump来兼容。</p>
<p>unpack 反序列化对象保存到文件对象。提供了load来兼容。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> msgpack</span><br><span class="line"></span><br><span class="line">d = &#123;<span class="string">&quot;person&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;tom&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="number">18</span>&#125;,&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;jerry&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="number">16</span>&#125;],<span class="string">&quot;total&quot;</span>:<span class="number">2</span>&#125;</span><br><span class="line">j = json.dumps(d)</span><br><span class="line"><span class="built_in">print</span>(j, <span class="built_in">type</span>(j), <span class="built_in">len</span>(j)) <span class="comment"># 请注意引号的变化</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(j.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>))) <span class="comment"># 72 bytes 注意这样替换的压缩是不对的</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">30</span>)</span><br><span class="line">p = pickle.dumps(d)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(p))  <span class="comment"># 101 bytes</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">30</span>)</span><br><span class="line">m = msgpack.dumps(d)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(m)) <span class="comment"># 48 bytes</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">30</span>)</span><br><span class="line">u = msgpack.unpackb(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(u), u)</span><br><span class="line">u = msgpack.loads(m, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(u), u)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;person&quot;: [&#123;&quot;name&quot;: &quot;tom&quot;, &quot;age&quot;: 18&#125;, &#123;&quot;name&quot;: &quot;jerry&quot;, &quot;age&quot;: 16&#125;], &quot;total&quot;: 2&#125; &lt;class &#x27;str&#x27;&gt; 82</span><br><span class="line">72</span><br><span class="line">------------------------------</span><br><span class="line">b&#x27;\x80\x03&#125;q\x00(X\x06\x00\x00\x00personq\x01]q\x02(&#125;q\x03(X\x04\x00\x00\x00nameq\x04X\x03\x00\x00\x00tomq\x05X\x03\x00\x00\x00ageq\x06K\x12u&#125;q\x07(h\x04X\x05\x00\x00\x00jerryq\x08h\x06K\x10ueX\x05\x00\x00\x00totalq\tK\x02u.&#x27;</span><br><span class="line">101</span><br><span class="line">------------------------------</span><br><span class="line">b&#x27;\x82\xa6person\x92\x82\xa4name\xa3tom\xa3age\x12\x82\xa4name\xa5jerry\xa3age\x10\xa5total\x02&#x27;</span><br><span class="line">48</span><br><span class="line">------------------------------</span><br><span class="line">&lt;class &#x27;dict&#x27;&gt; &#123;b&#x27;person&#x27;: [&#123;b&#x27;name&#x27;: b&#x27;tom&#x27;, b&#x27;age&#x27;: 18&#125;, &#123;b&#x27;name&#x27;: b&#x27;jerry&#x27;, b&#x27;age&#x27;: 16&#125;], b&#x27;total&#x27;: 2&#125;</span><br><span class="line">&lt;class &#x27;dict&#x27;&gt; &#123;&#x27;person&#x27;: [&#123;&#x27;name&#x27;: &#x27;tom&#x27;, &#x27;age&#x27;: 18&#125;, &#123;&#x27;name&#x27;: &#x27;jerry&#x27;, &#x27;age&#x27;: 16&#125;], &#x27;total&#x27;: 2&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/python/" rel="tag"># python</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2017/09/10/10python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%E3%80%81%E8%B7%AF%E5%BE%84%E5%A4%84%E7%90%86%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="prev" title="python-文件处理、路径处理、序列化和反序列化">
                  <i class="fa fa-chevron-left"></i> python-文件处理、路径处理、序列化和反序列化
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2017/09/22/11python%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E3%80%81%E6%A8%A1%E5%9D%97%E5%8C%96/" rel="next" title="python-异常处理、模块化">
                  python-异常处理、模块化 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">luoqian</span>
</div>
  <div class="powered-by">تطبيق الموقع <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
